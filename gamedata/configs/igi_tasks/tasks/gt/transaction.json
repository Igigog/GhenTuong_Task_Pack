{
	"preconditions": [
		"igi_actions.rank('endgame')"
	],
	"entities": [
	{
		"GEN": "igi_generate.Split('ids', 'id', 1)",
		"ids": "&igi_finder.get_smarts_string(1,1)&",
		"target":"assault",
		"section_name": "&igi_helper.se_object([this.id]):section_name()&",
		"link_id": "smart"
	},

	{
		"faction":"&igi_macros.Faction([CACHE.task_giver_id], 'enemy of taskgiver and enemy of actor')&",
		"section_name":"&igi_macros.TableValueByKey('gt_guard', '[this.faction]')&",
		"id": "!&igi_target_basic.squad_create([smart.id], '[this.section_name]').id&",
		"init": "!&igi_target_basic.init_squad([this.id])&",
		"link_id": "enemy"
	},

	{
		"faction":"&igi_macros.Faction([CACHE.task_giver_id], 'enemy of [enemy.faction]')&",
		"section_name":"&igi_macros.TableValueByKey('gt_guard', '[this.faction]')&",
		"id": "!&igi_target_basic.squad_create([smart.id], '[this.section_name]').id&",
		"init": "!&igi_target_basic.init_squad([this.id])&",
		"link_id": "traitor"
	},

	{
		"GEN": "igi_generate.Amount(2)",
		"section_name":"&igi_utils.choose('gt_package_weapon','gt_package_artifact')&",
		"target":"return",
		"id": "!&igi_target_basic.create_on_smart('[this.section_name]', [smart.id])&",
		"to_description":true,
		"mark": "treasure_unique",
		"to_create": true,
		"where": "[smart.id]",
		"link_id": "package"
	}
	],
	"actions": [
	{
		"when": "igi_actions.is_online([traitor.id])",
		"run": "igi_actions.change_faction([traitor.id], '[enemy.faction]')"
	}],
	"icon": "ui_inGame2_Sdelka",
	"quest_givers": [
		{"Mechanic": true}
	]
}